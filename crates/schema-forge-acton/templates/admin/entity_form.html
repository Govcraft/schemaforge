{% extends "admin/base.html" %}

{% block title %}
{% if let Some(id) = entity_id %}Edit Entity{% else %}Create {{ schema.name }}{% endif %} - SchemaForge Admin
{% endblock %}

{% block content %}
<div class="breadcrumbs text-sm">
    <ul>
        <li><a href="/admin/">Dashboard</a></li>
        <li><a href="{{ url_prefix }}/{{ schema.url_name }}">{{ schema.name }}</a></li>
        <li><a href="{{ url_prefix }}/{{ schema.url_name }}/entities">Entities</a></li>
        <li>{% if let Some(id) = entity_id %}Edit{% else %}Create{% endif %}</li>
    </ul>
</div>
<div class="flex justify-between items-center mb-6">
    <h2>{% if let Some(id) = entity_id %}Edit Entity{% else %}Create {{ schema.name }}{% endif %}</h2>
</div>

{% if !errors.is_empty() %}
<div class="alert alert-error">
    <strong>Please fix the following errors:</strong>
    <ul class="mt-2 ml-5 list-disc">
        {% for error in errors %}
        <li>{{ error }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<div class="card card-border bg-base-200">
    <div class="card-body">
    <form
        {% if let Some(id) = entity_id %}
        hx-put="{{ url_prefix }}/{{ schema.url_name }}/entities/{{ id }}"
        {% else %}
        hx-post="{{ url_prefix }}/{{ schema.url_name }}/entities"
        {% endif %}
        hx-target="body"
        hx-push-url="true"
    >
        {% for field in fields %}
        {% include "admin/fragments/field_input.html" %}
        {% endfor %}

        <div class="flex gap-3 mt-6">
            <button type="submit" class="btn btn-primary">
                {% if entity_id.is_some() %}Update{% else %}Create{% endif %}
            </button>
            <a href="{{ url_prefix }}/{{ schema.url_name }}/entities" class="btn btn-ghost">Cancel</a>
        </div>
    </form>
    </div>
</div>
{% endblock %}
